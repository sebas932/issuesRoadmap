<html>
    <head>
        <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
        <title>Issues GitHub - {{ repoInfo.full_name }}</title>

        <!-- Compiled and minified CSS -->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
        <link rel="stylesheet" href="//cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
        <link rel="stylesheet" href="../../css/master.css">

    </head>
    <body>
      <header>
        <div class="container">
          <h2 class="display-1">Issues GitHub</h2>

          <!-- Go back  -->
          <div class="form-group">
            <a class="waves-effect waves-light btn" href="./../"><i class="material-icons left">arrow_back</i> Go Back</a>
          </div>
        </div>
      </header>

      <div class="">
        <div class="leftBar">
          {% if hideFilters != true %}
          <!-- Repo Logo -->
          <div class="form-group">
            <div class="center-align">
              <img src="{{ repoInfo.owner.avatar_url }}" class="rounded " width="80" alt="">
              <h5>{{ repoInfo.full_name }}</h5>
              <p>{{ repoInfo.description }}</p>
              <small> ID: <code>{{ repoInfo.id }} </code></small>
            </div>
          </div>
          <br>
          <form action="">
            <!-- Milestone Filter -->
            <div class="input-field col s12">
              <strong>Milestone:</strong>
              <select name="milestoneID">
                <option value="" >All</option>
                {% for milestone in milestones %}
                  <option value="{{ milestone.number }}" {% if (milestone.number == milestoneID) %}selected{% endif %}>{{ milestone.title }}</option>
                {% endfor %}
              </select>
            </div>
            <!-- Zenhub Data -->
            <p><strong>Zenhub:</strong></p>
            <div class="form-group">
              <label>
                <input type="checkbox" class="filled-in" name="zenhubActive" value="true" {% if zenhubActive %}checked="checked"{% endif%} />
                <span>Show Data</span>
              </label>
            </div>
            <!-- Issues State -->
            <p><strong>GitHub Status:</strong></p>
            <div class="form-group">
              <label>
                <input class="with-gap" name="state" type="radio" value="open" {% if state == "open" %}checked{% endif %} />
                <span>Open</span>
              </label>
              <br>
              <label>
                <input class="with-gap" name="state" type="radio" value="closed" {% if state == "closed" %}checked{% endif %} />
                <span>Closed</span>
              </label>
              <br>
              <label>
                <input class="with-gap" name="state" type="radio" value="all" {% if state == "all" %}checked{% endif %} />
                <span>Both <small>(All)</small></span>
              </label>
            </div>
            <br>
            <button class="btn btn-outline-secondary right" type="submit">Find Issues</button>
          </form>
          {% endif %}
        </div>


        <div class="rightBar {{ hideFilters? 'hideblock': 'show' }}">
          {% if milestoneID is not empty %}
          <div class="left-align">
            <h5>{{ milestoneInfo.title }}</h5>
            <p>Due on: {{ milestoneInfo.due_on|date("M/d/Y") }}</p>
          </div>
          {% endif%}

          <div class="row">

            <div class="col m2">
              <div class="card topIndicator">
                <div class="card-content">
                  <span class="card-title"> Total</span>
                  <p><h3>{{ issues|length }}</h3></p>
                  {% if zenhubActive %}
                    <p><strong> Total Estimated</strong> <br>{{ chartsData.totalEstimate }}</p>
                  {% endif %}
                </div>
              </div>
            </div>

            <div class="col m3">
              <div class="card topIndicator">
                <div class="card-content">
                  <span class="card-title">State</strong> {% if zenhubActive %} <br><small>(Estimated by State)</small>{% endif %}</span>
                  <div class="chart-container"><canvas id="chartCanvas-0"></canvas></div>
                  <code class="chartData-0 hide"> {{ chartsData.states|json_encode }} </code>
                </div>
              </div>
            </div>

            <div class="col m3">
              <div class="card topIndicator">
                <div class="card-content">
                  <span class="card-title">Type</strong> {% if zenhubActive %} <br><small>(Estimated by Type)</small>{% endif %}</span>
                  <div class="chart-container"><canvas id="chartCanvas-1"></canvas></div>
                  <code class="chartData-1 hide"> {{ chartsData.types|json_encode }} </code>
                </div>
              </div>
            </div>

            <div class="col m2">
              <div class="card topIndicator">
                <div class="card-content">
                  <span class="card-title">Responsible</strong> {% if zenhubActive %} <br><small>(Estimated by Responsible)</small>{% endif %}</span>
                  <div class="chart-container"><canvas id="chartCanvas-3"></canvas></div>
                  <code class="chartData-3 hide"> {{ chartsData.users|json_encode }} </code>
                </div>
              </div>
            </div>

            <div class="col m2">
              <div class="card topIndicator">
                <div class="card-content">
                  <span class="card-title">Priority</strong> {% if zenhubActive %} <br><small>(Estimated by Priority)</small>{% endif %}</span>
                  <div class="chart-container"><canvas id="chartCanvas-2"></canvas></div>
                  <code class="chartData-2 hide"> {{ chartsData.priorities|json_encode }} </code>
                </div>
              </div>
            </div>

          </div>
          <!-- <p>Total issues found: <strong>{{ issues|length }}</strong></p> -->



          <table id="issuesList" class="table table-striped table-bordered striped" style="width:100%">
            <thead>
              <tr>
                <th>GitHub ID</th>
                <th>Milestone</th>
                <th>Title</th>
                <!-- <th>Label(s)</th> -->
                <th>Type</th>
                <th>Priority</th>
                <th>Responsible</th>
                <th>Status</th>
                {% if zenhubActive %}
                  <th>Estimate <br><small>ZenHub</small></th>
                  <th>Pipeline <br><small>ZenHub</small></th>
                {% endif%}
                <th>Created At</th>
                <th>Updated At</th>
                <th>Closed At</th>
              </tr>
            </thead>
            <tbody>
              {% for issue in issues %}
                <tr>
                  <td class="center-align"> <a href="{{ issue.html_url}}">{{ issue.number }} </a> </td>
                  <td>
                    {{ issue.milestone.title }}
                  </td>
                  <td>

                    {{ issue.title }}
                  </td>
                  <!--
                  <td>
                    {% for label in issue.labels %}
                      <span class="badge " style="border-bottom-color: #{{ label.color }};">{{ label.name }}</span>
                    {% endfor %}
                  </td>
                   -->
                  <td class="center-align"> {{ issue.type }} </td>
                  <td class="center-align"> {{ issue.priority }} </td>
                  <td class="center-align"> {{ issue.assigneAcronym }} </td>
                  <td class="center-align"> {{ issue.state}}</td>
                  {% if zenhubActive %}
                    <td class="center-align"> {{ issue.zenhub.estimate.value }} </td>
                    <td class="center-align pipeline-{{ issue.zenhub.pipeline.name|replace(' ', '-')|replace('/', '-') }}"> {{ issue.zenhub.pipeline.name }} </td>
                  {% endif %}
                  <td> <small>{{ issue.created_at }}</small> </td>
                  <td> <small>{{ issue.updated_at }}</small> </td>
                  <td> <small>{{ issue.closed_at  }}</small> </td>
                </tr>
              {% endfor %}

            </tbody>
          </table>
          <footer>
            <br><code>{{ query }}</code>
          </footer>
        </div>

      </div>



      <!-- Compiled and minified JavaScript -->
      <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/js/materialize.min.js"></script>
      <script src="//cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js" charset="utf-8"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
      <script src="../../js/main.js" charset="utf-8"></script>

    </body>

</html>
